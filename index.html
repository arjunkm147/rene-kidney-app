<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>REN√â - Kidney Health Hero</title>

  <!-- React + Babel + Tailwind CDN -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tailwind config (works with CDN) -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        container: { center: true, padding: { DEFAULT: '1rem', sm: '1.25rem', lg: '2rem' } },
        extend: {
          colors: {
            brand: {
              50: '#fff4f2', 100: '#fee6e2', 200: '#f8cdc7', 300: '#efaaa1', 400: '#e0877d',
              500: '#c86e64', 600: '#a75954', 700: '#8d4946', 800: '#6f3b39', 900: '#5a3230'
            },
            accent: { 50: '#fff7ed', 100: '#ffedd5', 500: '#f97316', 600: '#ea580c' },
            good: '#10b981'
          },
          fontFamily: {
            sans: [
              'Inter', 'ui-sans-serif', 'system-ui', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial',
              'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'
            ]
          },
          borderRadius: { xl: '1rem', '2xl': '1.25rem' },
          boxShadow: {
            soft: '0 2px 10px rgba(15,23,42,0.06)',
            card: '0 6px 24px rgba(15,23,42,0.08)'
          }
        }
      }
    }
  </script>

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#a75954" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="REN√â" />
  <link rel="apple-touch-icon" href="rene-logo-new.png" />
  <link rel="manifest" href="manifest.json" />

  <!-- Fonts & base styles -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root { --bg-grad-start:#f8fafc; --bg-grad-end:#e2e8f0; }
    html, body { height: 100%; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, var(--bg-grad-start) 0%, var(--bg-grad-end) 100%);
      margin: 0; line-height: 1.55; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    .rene-gradient { background: linear-gradient(135deg, #8b5a5a 0%, #a0706e 25%, #b8857f 50%, #d4a574 100%); }
    .card { background:#fff; border:1px solid #e2e8f0; border-radius:1rem; box-shadow:0 6px 24px rgba(15,23,42,.06); }
    .card-hover { transition:box-shadow .2s, transform .2s, border-color .2s; }
    .card-hover:hover { transform:translateY(-2px); box-shadow:0 10px 30px rgba(15,23,42,.10); border-color:#cbd5e1; }
    .progress-track{height:6px;background:#e2e8f0;border-radius:999px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,#10b981 0%,#059669 100%);border-radius:999px;transition:width .4s cubic-bezier(.16,1,.3,1)}
    .floating-header{position:sticky;top:0;z-index:10;backdrop-filter:blur(10px);border-bottom:1px solid rgba(226,232,240,.9)}
    .bottom-nav{background:rgba(255,255,255,.95);backdrop-filter:blur(10px);border-top:1px solid #e2e8f0;box-shadow:0 -6px 24px rgba(15,23,42,.06)}
    .app-shell{max-width:100%}
    @media (min-width:640px){.app-shell{max-width:480px}}
    @media (min-width:768px){.app-shell{max-width:800px}}
    @media (min-width:1024px){.app-shell{max-width:1000px}}
    .notification{position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:1000;max-width:520px}
  </style>
</head>
<body>
  <div id="root">
    <div class="min-h-screen grid place-items-center text-brand-600">
      <div class="text-center animate-pulse">
        <img src="rene-logo-new.png" alt="REN√â Logo" class="w-20 h-20 mx-auto mb-4 object-contain" />
        <div class="text-3xl font-extrabold">REN√â</div>
        <div class="text-base text-brand-500 mt-1">Kidney Coach</div>
        <div class="text-xs text-slate-500 mt-3">Loading your health journey...</div>
      </div>
    </div>
  </div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Shell & tokens
    const Shell = ({ children }) => (
      <div className="app-shell container mx-auto min-h-screen bg-white md:rounded-2xl md:shadow-card md:border md:border-slate-200 relative">
        {children}
      </div>
    );
    const Section = ({ children, className = '' }) => (<div className={`px-5 sm:px-6 md:px-8 ${className}`}>{children}</div>);
    const Card = ({ children, className = '' }) => (<div className={`card card-hover ${className}`}>{children}</div>);

    // Stat supports onGradient variant so it doesn't look washed out
    const Stat = ({ label, value, sub, className = '', variant = 'default' }) => {
      const isGradient = variant === 'onGradient';
      return (
        <div className={`rounded-xl text-center p-4 ${isGradient ? 'bg-white/10 border border-white/20 text-white' : 'bg-slate-50 border border-slate-200 text-slate-900'} ${className}`}>
          <div className={`text-2xl font-bold mb-1 ${isGradient ? 'text-white' : 'text-slate-900'}`}>{value}</div>
          <div className={`text-xs font-medium ${isGradient ? 'text-white/90' : 'text-slate-600'}`}>{label}</div>
          {sub && <div className={`text-[11px] mt-1 ${isGradient ? 'text-white/80' : 'text-slate-500'}`}>{sub}</div>}
        </div>
      );
    };

    const ReneBrand = ({ size = 'md' }) => {
      const sizes = { sm: ['w-8 h-8', 'text-lg'], md: ['w-12 h-12', 'text-2xl'], lg: ['w-16 h-16', 'text-3xl'] };
      const [img, txt] = sizes[size] || sizes.md;
      return (
        <div className="inline-flex items-center gap-3 select-none">
          <img src="rene-logo-new.png" alt="REN√â" className={`${img} object-contain drop-shadow`} />
          <span className={`font-extrabold text-white ${txt}`}>REN√â</span>
        </div>
      );
    };

    const Notification = ({ notice }) => notice && (
      <div className={`notification px-5 py-3 rounded-xl shadow-card text-white ${notice.type === 'success' ? 'bg-emerald-500' : 'bg-rose-500'}`}>
        <div className="flex items-center gap-2 text-sm font-semibold">
          <span>{notice.type === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}</span>
          <span>{notice.message}</span>
        </div>
      </div>
    );

    // ---------- Helpers: notifications & scheduling ----------
    const hasNotificationSupport = () => 'Notification' in window;
    const hasServiceWorkerSupport = () => 'serviceWorker' in navigator;
    const getPermission = () => (hasNotificationSupport() ? Notification.permission : 'denied');

    // Create a Date object for the next occurrence of "HH:MM"
    function nextDateTimeAt(timeStr, daysMask /* optional Set of weekday numbers 0-6 */) {
      const [hh, mm] = timeStr.split(':').map(n => parseInt(n, 10));
      const now = new Date();
      let d = new Date();
      d.setHours(hh, mm, 0, 0);
      // If using day mask (e.g., dialysis days), roll to next allowed day/time
      if (daysMask && daysMask.size) {
        // If time already passed today or today not allowed, move forward day-by-day
        while (d <= now || !daysMask.has(d.getDay())) {
          d.setDate(d.getDate() + 1);
          d.setHours(hh, mm, 0, 0);
        }
      } else {
        if (d <= now) d.setDate(d.getDate() + 1);
      }
      return d;
    }

    // Show a browser notification (prefers SW if available)
    async function showBrowserNotification({ title, body, tag, data, icon = 'rene-logo-new.png', badge = 'rene-logo-new.png' }) {
      if (!hasNotificationSupport()) return false;

      try {
        if (hasServiceWorkerSupport()) {
          const reg = await navigator.serviceWorker.getRegistration();
          if (reg) {
            await reg.showNotification(title, { body, tag, data, icon, badge, requireInteraction: false, renotify: true });
            return true;
          }
        }
        // Fallback to window Notification (no actions)
        if (Notification.permission === 'granted') {
          new Notification(title, { body, tag, data, icon, badge });
          return true;
        }
      } catch (e) {
        console.warn('Notification error:', e);
      }
      return false;
    }

    // ---------- App ----------
    const App = () => {
      const [currentPage, setCurrentPage] = useState('home');
      const [notice, setNotice] = useState(null);

      // External Mobile Coach app link (opens in a new tab)
      const MOBILE_COACH_URL = 'https://app.mobile-coach.eu/dl/store?dm03-wSqDVy1PRjhhP7j1YT9t0VmDt5fDe3SV';

      // Reminders state (persisted in localStorage)
      const defaultReminders = {
        enabled: false,
        meds: [
          { id: 'med1', name: 'Morning meds', time: '08:30', enabled: true },
          { id: 'med2', name: 'Evening meds', time: '20:00', enabled: true },
        ],
        dialysis: {
          enabled: true,
          time: '08:00',
          // 0=Sun ... 6=Sat; default Mon/Wed/Fri = 1,3,5
          days: [1, 3, 5]
        },
        hydration: {
          enabled: true,
          intervalMins: 120,
          activeStart: '09:00',
          activeEnd: '19:00'
        }
      };
      const [reminders, setReminders] = useState(() => {
        try { return JSON.parse(localStorage.getItem('rene.reminders')) || defaultReminders; }
        catch { return defaultReminders; }
      });

      // In-memory timers so we can clear/reschedule
      const timersRef = useRef({ daily: [], dialysis: null, hydration: null });

      const [heroData, setHeroData] = useState({
        name: 'Leandro', age: 15, location: 'Lausanne', level: 8, xp: 1840, xpToNext: 2000, totalPoints: 15420, joinDate: 'March 2024'
      });

      const [streakData] = useState({
        currentStreak: 5, bestStreak: 7, medicationTaken: true, medicationTime: '08:30 AM',
        fluidIntake: 1400, fluidTarget: 2000, stepCount: 6200, stepTarget: 8000,
        intensityMinutes: 36, intensityTarget: 150, sleepHours: 7.5, moodRating: 4
      });

      const [todayGoals, setTodayGoals] = useState([
        { id: 1, title: 'Morning Medication', completed: true, xp: 50, icon: 'üíä' },
        { id: 2, title: 'Hydration Target (‚â§ 2L)', completed: false, xp: 30, icon: 'üíß' },
        { id: 3, title: 'Walk 8000 steps', completed: false, xp: 40, icon: 'üëü' },
        { id: 4, title: 'Evening Medication', completed: false, xp: 50, icon: 'üíä' },
        { id: 5, title: 'Mood Check-in', completed: false, xp: 20, icon: 'üòä' }
      ]);

      const [chatMessages, setChatMessages] = useState([
        { id: 1, user: 'Sofia', message: 'Completed 7-day streak üéâ', time: '5m', likes: 12, avatar: 'ü¶∏‚Äç‚ôÄÔ∏è' },
        { id: 2, user: 'Marcus', message: 'Intensity minutes up to 120 this week!', time: '18m', likes: 6, avatar: 'ü¶∏‚Äç‚ôÇÔ∏è' },
      ]);
      const [newMessage, setNewMessage] = useState('');

      // Dialysis session mock notifications
      const [dialysisActive, setDialysisActive] = useState(false);
      const dialysisTimerRef = useRef(null);

      const notify = (message, type = 'success', timeout = 2500) => {
        setNotice({ message, type });
        if (timeout) setTimeout(() => setNotice(null), timeout);
      };

      const completeGoal = (id) => {
        setTodayGoals(gs => gs.map(g => g.id === id ? { ...g, completed: true } : g));
        const g = todayGoals.find(x => x.id === id);
        if (g && !g.completed) { setHeroData(h => ({ ...h, xp: h.xp + g.xp })); notify(`+${g.xp} XP ‚Ä¢ ${g.title}`); }
      };

      const sendMessage = () => {
        if (!newMessage.trim()) return;
        setChatMessages(ms => [{ id: ms.length + 1, user: heroData.name, message: newMessage, time: 'now', likes: 0, avatar: 'ü¶∏' }, ...ms]);
        setNewMessage('');
        notify('Message sent');
      };

      const startDialysis = () => {
        if (dialysisActive) return;
        setDialysisActive(true);
        notify('Dialysis session started. You will get periodic check-ins.', 'success', 3000);
        // Demo interval (set to 60000 for 1 min; in production 30 * 60 * 1000)
        dialysisTimerRef.current = setInterval(() => {
          notify('How are you feeling? Tap to log symptoms.', 'success', 4000);
        }, 60000);
      };
      const stopDialysis = () => {
        setDialysisActive(false);
        if (dialysisTimerRef.current) { clearInterval(dialysisTimerRef.current); dialysisTimerRef.current = null; }
        notify('Session ended', 'success');
      };
      useEffect(() => () => { if (dialysisTimerRef.current) clearInterval(dialysisTimerRef.current); }, []);

      // ---- Notifications: permission + SW registration
      const [perm, setPerm] = useState(getPermission());
      const [swReady, setSwReady] = useState(false);

      useEffect(() => {
        async function boot() {
          if (hasServiceWorkerSupport()) {
            try {
              const reg = await navigator.serviceWorker.register('sw.js');
              await navigator.serviceWorker.ready;
              setSwReady(true);
            } catch (e) {
              console.warn('SW register failed (still fine for window notifications):', e);
            }
          }
        }
        boot();
      }, []);

      const requestPermission = async () => {
        if (!hasNotificationSupport()) { notify('Notifications not supported on this browser', 'error'); return; }
        try {
          const result = await Notification.requestPermission();
          setPerm(result);
          if (result === 'granted') {
            notify('Notifications enabled ‚úÖ');
          } else {
            notify('Notifications blocked ‚ùå', 'error');
          }
        } catch (e) {
          notify('Permission request failed', 'error');
        }
      };

      // ---- Scheduling logic (local, while app/PWA is running)
      const clearAllTimers = () => {
        timersRef.current.daily.forEach(id => clearTimeout(id));
        timersRef.current.daily = [];
        if (timersRef.current.dialysis) clearTimeout(timersRef.current.dialysis);
        timersRef.current.dialysis = null;
        if (timersRef.current.hydration) clearInterval(timersRef.current.hydration);
        timersRef.current.hydration = null;
      };

      function scheduleAll() {
        clearAllTimers();
        if (!reminders.enabled) return;

        // MEDS ‚Äî schedule each enabled time today/tomorrow, then reschedule +24h on fire
        for (const m of reminders.meds) {
          if (!m.enabled) continue;
          const target = nextDateTimeAt(m.time);
          const delay = Math.max(0, target - new Date());
          const id = setTimeout(function tick() {
            showBrowserNotification({
              title: `üíä ${m.name}`,
              body: `It's ${m.time}. Mark medication as taken.`,
              tag: `med-${m.id}-${m.time}`,
              data: { url: location.href + '#meds' }
            }).then(ok => { if (!ok) notify(`üíä ${m.name} reminder`, 'success'); });
            // reschedule for next day
            const next = nextDateTimeAt(m.time);
            const nextDelay = Math.max(0, next - new Date());
            const newId = setTimeout(tick, nextDelay);
            // replace id reference
            const idx = timersRef.current.daily.indexOf(id);
            if (idx !== -1) timersRef.current.daily[idx] = newId;
          }, delay);
          timersRef.current.daily.push(id);
        }

        // DIALYSIS ‚Äî schedule next allowed weekday at given time
        if (reminders.dialysis?.enabled && reminders.dialysis.days?.length) {
          const daysSet = new Set(reminders.dialysis.days);
          const t = nextDateTimeAt(reminders.dialysis.time, daysSet);
          const delay = Math.max(0, t - new Date());
          timersRef.current.dialysis = setTimeout(function rearm() {
            showBrowserNotification({
              title: 'ü©∫ Dialysis today',
              body: `Session at ${reminders.dialysis.time}. Do a quick check-in?`,
              tag: 'dialysis-reminder',
              data: { url: location.href + '#dialysis' }
            }).then(ok => { if (!ok) notify('ü©∫ Dialysis reminder', 'success'); });
            // reschedule for next allowed day
            const next = nextDateTimeAt(reminders.dialysis.time, daysSet);
            const nextDelay = Math.max(0, next - new Date());
            timersRef.current.dialysis = setTimeout(rearm, nextDelay);
          }, delay);
        }

        // HYDRATION ‚Äî periodic during active hours
        if (reminders.hydration?.enabled) {
          const intervalMs = Math.max(15, reminders.hydration.intervalMins || 120) * 60 * 1000;
          timersRef.current.hydration = setInterval(() => {
            const now = new Date();
            const inWindow = (ts) => {
              const [sh, sm] = (reminders.hydration.activeStart || '09:00').split(':').map(n=>parseInt(n,10));
              const [eh, em] = (reminders.hydration.activeEnd || '19:00').split(':').map(n=>parseInt(n,10));
              const s = new Date(ts); s.setHours(sh, sm, 0, 0);
              const e = new Date(ts); e.setHours(eh, em, 0, 0);
              return ts >= s && ts <= e;
            };
            if (inWindow(now)) {
              showBrowserNotification({
                title: 'üíß Hydration target',
                body: 'Quick sip time. Keep within your daily target.',
                tag: 'hydration-nudge',
                data: { url: location.href }
              }).then(ok => { if (!ok) notify('üíß Hydration nudge', 'success'); });
            }
          }, intervalMs);
        }
      }

      // Persist reminders & reschedule when they change
      useEffect(() => {
        localStorage.setItem('rene.reminders', JSON.stringify(reminders));
        scheduleAll();
        // eslint-disable-next-line react-hooks/exhaustive-deps
      }, [reminders]);

      // ---------- Pages ----------
      const Home = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-6">
              <div className="flex items-center justify-between">
                <ReneBrand size="md" />
                <div className="text-right text-white/95">
                  <div className="text-xs opacity-90 font-medium">Welcome back</div>
                  <div className="font-bold text-lg">{heroData.name}</div>
                  <div className="text-[11px] opacity-85 mt-0.5">{heroData.age} ‚Ä¢ {heroData.location}</div>
                </div>
              </div>

              {/* XP strip */}
              <Card className="mt-5 p-5">
                <div className="flex items-start justify-between">
                  <div>
                    <div className="text-2xl font-extrabold text-slate-800">Level {heroData.level}</div>
                    <div className="text-xs text-slate-600 font-medium">Kidney Health Hero</div>
                  </div>
                  <div className="text-right">
                    <div className="text-xl font-extrabold text-accent-600">{heroData.xp}</div>
                    <div className="text-[11px] text-slate-500 font-medium">XP Points</div>
                  </div>
                </div>
                <div className="progress-track mt-3">
                  <div className="progress-fill" style={{ width: `${(heroData.xp / heroData.xpToNext) * 100}%` }} />
                </div>
                <div className="text-[11px] text-slate-600 font-medium mt-1.5">
                  {heroData.xpToNext - heroData.xp} XP to Level {heroData.level + 1}
                </div>
              </Card>
            </Section>
          </div>

          <Section className="py-6 space-y-8 pb-28">
            {/* Streak card with solid-on-gradient stats */}
            <div className="rounded-2xl p-6 text-white shadow-card bg-gradient-to-tr from-orange-500 via-orange-400 to-amber-400">
              <div className="flex items-start justify-between">
                <div>
                  <h3 className="text-2xl font-extrabold mb-1">üî• {streakData.currentStreak} Day Streak</h3>
                  <p className="text-white/90 text-xs font-medium">Best: {streakData.bestStreak} days</p>
                </div>
                <span className="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-white/90 text-orange-800">Active</span>
              </div>

              <div className="mt-5 grid grid-cols-7 gap-2">
                {[...Array(7)].map((_, i) => (
                  <div key={i} className={`${i < streakData.currentStreak ? 'bg-white' : 'bg-white/40'} h-3 rounded-full`} />
                ))}
              </div>

              <div className="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-4">
                <Stat variant="onGradient" label="Medicine" value={streakData.medicationTaken ? '‚úì' : '‚óã'} />
                <Stat variant="onGradient" label="Hydration Target" value={`${Math.round((streakData.fluidIntake / streakData.fluidTarget) * 100)}%`} sub={`${streakData.fluidIntake} / ${streakData.fluidTarget} ml`} />
                <Stat variant="onGradient" label="Steps" value={`${(streakData.stepCount/1000).toFixed(1)}k`} sub={`Target ${Math.round(streakData.stepTarget/1000)}k`} />
                <Stat variant="onGradient" label="Intensity min" value={`${streakData.intensityMinutes}m`} sub={`/ ${streakData.intensityTarget} weekly`} />
              </div>
            </div>

            {/* Quick Access modules */}
            <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
              {/* Mobile Coach external app */}
              <a href={MOBILE_COACH_URL} target="_blank" rel="noopener noreferrer" className="block focus:outline-none focus:ring-2 focus:ring-accent-500 rounded-xl">
                <Card className="p-5">
                  <div className="text-3xl mb-2">üì±</div>
                  <div className="font-bold text-slate-800">Chat with RENE Coach</div>
                  <div className="text-sm text-slate-600">Open chat app</div>
                  <div className="mt-2 text-accent-600 text-sm font-semibold">Open in new tab ‚Üí</div>
                </Card>
              </a>

              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('reminders')}>
                <div className="text-3xl mb-2">‚è∞</div>
                <div className="font-bold text-slate-800">Reminders</div>
                <div className="text-sm text-slate-600">Dialysis ‚Ä¢ Meds ‚Ä¢ Hydration</div>
              </Card>

              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('goals')}>
                <div className="text-3xl mb-2">‚öôÔ∏è</div>
                <div className="font-bold text-slate-800">Mission Center</div>
                <div className="text-sm text-slate-600">Track your daily goals</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('chat')}>
                <div className="text-3xl mb-2">üë•</div>
                <div className="font-bold text-slate-800">Hero Alliance</div>
                <div className="text-sm text-slate-600">Challenges & leaderboard</div>
                <div className="flex items-center gap-2 mt-1"><span className="w-2 h-2 rounded-full bg-emerald-500"></span><span className="text-[11px] font-semibold text-emerald-600">4 online</span></div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('wellness')}>
                <div className="text-3xl mb-2">üßò</div>
                <div className="font-bold text-slate-800">Wellness</div>
                <div className="text-sm text-slate-600">Mindfulness & content</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('dialysis')}>
                <div className="text-3xl mb-2">ü©∫</div>
                <div className="font-bold text-slate-800">Dialysis</div>
                <div className="text-sm text-slate-600">Session tools & check-ins</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('symptoms')}>
                <div className="text-3xl mb-2">üìù</div>
                <div className="font-bold text-slate-800">Symptom Tracker</div>
                <div className="text-sm text-slate-600">Quick daily check-in</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={() => setCurrentPage('meds')}>
                <div className="text-3xl mb-2">üíä</div>
                <div className="font-bold text-slate-800">Medication Overview</div>
                <div className="text-sm text-slate-600">Doses & reminders</div>
              </Card>
            </div>
          </Section>

          {/* Bottom nav */}
          <div className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-screen-lg bottom-nav">
            <div className="mx-auto max-w-[1000px]">
              <div className="grid grid-cols-4 gap-2 px-4 py-3">
                <button className="flex flex-col items-center rounded-lg py-1 text-accent-600 bg-accent-50 font-semibold"><div className="text-xl">üè†</div><span className="text-[11px]">Home</span></button>
                <button onClick={() => setCurrentPage('goals')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üéØ</div><span className="text-[11px] font-medium">Goals</span></button>
                <button onClick={() => setCurrentPage('chat')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë•</div><span className="text-[11px] font-medium">Heroes</span></button>
                <button onClick={() => setCurrentPage('profile')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë§</div><span className="text-[11px] font-medium">Profile</span></button>
              </div>
            </div>
          </div>
        </Shell>
      );

      const Goals = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Mission Center</span>
            </Section>
          </div>

          <Section className="py-6 space-y-6 pb-28">
            <Card className="p-5">
              <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2"><span>üìä</span> Today's Progress</h3>
              <div className="grid sm:grid-cols-2 gap-4">
                <Stat label="Goals Complete" value={`${todayGoals.filter(g => g.completed).length}/${todayGoals.length}`} />
                <Stat label="XP Earned" value={todayGoals.filter(g=>g.completed).reduce((s,g)=>s+g.xp,0)} />
              </div>
            </Card>

            <div className="space-y-3">
              <h3 className="text-lg font-bold text-slate-800 flex items-center gap-2"><span>üéØ</span> All Missions</h3>
              {todayGoals.map(goal => (
                <Card key={goal.id} className="p-5">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <span className="text-3xl">{goal.icon}</span>
                      <div>
                        <div className={`text-base font-bold ${goal.completed ? 'line-through text-slate-500' : 'text-slate-800'}`}>{goal.title}</div>
                        <p className="text-xs text-slate-600 mt-0.5">{goal.completed ? 'Completed today! Great job!' : `Complete to earn ${goal.xp} XP`}</p>
                      </div>
                    </div>
                    <button onClick={() => completeGoal(goal.id)} disabled={goal.completed} className={`px-5 py-2 rounded-lg font-bold text-sm ${goal.completed ? 'bg-emerald-600 text-white' : 'bg-accent-600 hover:bg-accent-500 text-white'}`}>{goal.completed ? '‚úì Done' : 'Complete'}</button>
                  </div>
                </Card>
              ))}
            </div>
          </Section>

          <div className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-screen-lg bottom-nav">
            <div className="mx-auto max-w-[1000px]">
              <div className="grid grid-cols-4 gap-2 px-4 py-3">
                <button onClick={() => setCurrentPage('home')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üè†</div><span className="text-[11px] font-medium">Home</span></button>
                <button className="flex flex-col items-center rounded-lg py-1 text-accent-600 bg-accent-50 font-semibold"><div className="text-xl">üéØ</div><span className="text-[11px]">Goals</span></button>
                <button onClick={() => setCurrentPage('chat')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë•</div><span className="text-[11px] font-medium">Heroes</span></button>
                <button onClick={() => setCurrentPage('profile')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë§</div><span className="text-[11px] font-medium">Profile</span></button>
              </div>
            </div>
          </div>
        </Shell>
      );

      const Chat = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Hero Alliance</span>
            </Section>
          </div>

          <Section className="py-4 space-y-4 pb-28">
            <Card className="p-4">
              <div className="flex items-center justify-between">
                <span className="text-sm font-bold text-slate-700 flex items-center gap-2"><span className="text-lg">üåü</span> Heroes Online</span>
                <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-emerald-500"></span><span className="text-[11px] font-bold text-emerald-600">4 active</span></div>
              </div>
            </Card>

            {/* Challenges */}
            <Card className="p-4">
              <div className="flex items-center justify-between mb-2">
                <h3 className="text-slate-800 font-bold">Challenges</h3>
                <button className="text-sm px-3 py-1 rounded-lg bg-accent-600 text-white" onClick={() => notify('Challenge created')}>New</button>
              </div>
              <div className="grid sm:grid-cols-2 gap-3">
                <div className="border rounded-lg p-3 flex items-center justify-between">
                  <div>
                    <div className="font-semibold">Hydration target 3-day streak</div>
                    <div className="text-xs text-slate-500">You vs. Sofia</div>
                  </div>
                  <button className="text-sm px-3 py-1 rounded bg-slate-100" onClick={() => notify('Challenge sent!')}>Challenge</button>
                </div>
                <div className="border rounded-lg p-3 flex items-center justify-between">
                  <div>
                    <div className="font-semibold">Intensity minutes 100/week</div>
                    <div className="text-xs text-slate-500">Open challenge</div>
                  </div>
                  <button className="text-sm px-3 py-1 rounded bg-slate-100" onClick={() => notify('Joined challenge')}>Join</button>
                </div>
              </div>
            </Card>

            {/* Leaderboard */}
            <Card className="p-4">
              <h3 className="text-slate-800 font-bold mb-3">Leaderboard (This week)</h3>
              <div className="divide-y">
                {[{u:'Leandro',xp:420},{u:'Sofia',xp:380},{u:'Marcus',xp:310},{u:'Emma',xp:280}].map((r,i)=> (
                  <div key={i} className="flex items-center justify-between py-2">
                    <div className="flex items-center gap-3">
                      <span className="w-6 text-center font-bold">{i+1}</span>
                      <span className="font-medium">{r.u}</span>
                    </div>
                    <span className="text-sm font-semibold text-slate-700">{r.xp} XP</span>
                  </div>
                ))}
              </div>
            </Card>

            {/* Chat feed */}
            <div className="space-y-3 min-h-[30vh]">
              {chatMessages.map(m => (
                <Card key={m.id} className="p-4">
                  <div className="flex gap-4">
                    <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-rose-800 to-rose-600 text-white grid place-items-center text-xl">{m.avatar}</div>
                    <div className="flex-1">
                      <div className="flex items-center justify-between mb-1"><span className="font-bold text-slate-800">{m.user}</span><span className="text-[11px] text-slate-500 font-medium">{m.time}</span></div>
                      <p className="text-slate-700 mb-3 leading-relaxed">{m.message}</p>
                      <div className="flex items-center justify-between text-sm">
                        <button onClick={() => setChatMessages(prev => prev.map(x => x.id === m.id ? { ...x, likes: x.likes + 1 } : x))} className="inline-flex items-center gap-2 text-slate-500 hover:text-rose-600"><span>‚ù§Ô∏è</span><span className="font-medium">{m.likes}</span></button>
                        <button className="text-slate-500 hover:text-slate-700 font-medium">Reply</button>
                      </div>
                    </div>
                  </div>
                </Card>
              ))}
            </div>
          </Section>

          <div className="fixed bottom-16 left-1/2 -translate-x-1/2 w-full max-w-screen-lg px-4">
            <Card className="p-3">
              <div className="flex gap-3">
                <input type="text" value={newMessage} onChange={(e)=>setNewMessage(e.target.value)} onKeyDown={(e)=>e.key==='Enter' && sendMessage()} placeholder="Send encouragement to fellow heroes..." className="flex-1 px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-accent-500" />
                <button onClick={sendMessage} disabled={!newMessage.trim()} className="px-5 py-2 rounded-lg font-bold bg-accent-600 text-white disabled:opacity-60">Send</button>
              </div>
            </Card>
          </div>

          <div className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-screen-lg bottom-nav">
            <div className="mx-auto max-w-[1000px]">
              <div className="grid grid-cols-4 gap-2 px-4 py-3">
                <button onClick={() => setCurrentPage('home')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üè†</div><span className="text-[11px] font-medium">Home</span></button>
                <button onClick={() => setCurrentPage('goals')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üéØ</div><span className="text-[11px] font-medium">Goals</span></button>
                <button className="flex flex-col items-center rounded-lg py-1 text-accent-600 bg-accent-50 font-semibold"><div className="text-xl">üë•</div><span className="text-[11px]">Heroes</span></button>
                <button onClick={() => setCurrentPage('profile')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë§</div><span className="text-[11px] font-medium">Profile</span></button>
              </div>
            </div>
          </div>
        </Shell>
      );

      const Profile = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Profile</span>
            </Section>
          </div>

          <Section className="py-6 space-y-6 pb-28">
            <div className="text-center">
              <div className="w-24 h-24 mx-auto rounded-2xl grid place-items-center bg-white/90 border border-white shadow-soft text-4xl">ü¶∏‚Äç‚ôÄÔ∏è</div>
              <h2 className="text-2xl font-extrabold text-slate-800 mt-3">{heroData.name}</h2>
              <p className="text-slate-600 text-sm">Level {heroData.level} Kidney Health Hero</p>
              <p className="text-slate-500 text-xs">{heroData.age} ‚Ä¢ {heroData.location} ‚Ä¢ since {heroData.joinDate}</p>
            </div>

            <Card className="p-5">
              <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2"><span>üìä</span> Your Stats</h3>
              <div className="grid sm:grid-cols-2 md:grid-cols-4 gap-4">
                <Stat label="Total XP" value={heroData.totalPoints} />
                <Stat label="Best Streak" value={streakData.bestStreak} />
                <Stat label="Medication Rate" value={'94%'} />
                <Stat label="Achievements" value={2} />
              </div>
            </Card>

            <Card className="p-5">
              <h3 className="text-lg font-bold text-slate-800 mb-2 flex items-center gap-2"><span>üí¨</span> Need Help?</h3>
              <p className="text-slate-600 text-sm mb-4">Our support team is here 24/7 to help with any questions about REN√â or your kidney health journey.</p>
              <button onClick={() => notify('Support is here.')} className="w-full px-5 py-3 rounded-lg font-bold bg-accent-600 hover:bg-accent-500 text-white">Contact Support Team</button>
            </Card>
          </Section>

          <div className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-screen-lg bottom-nav">
            <div className="mx-auto max-w-[1000px]">
              <div className="grid grid-cols-4 gap-2 px-4 py-3">
                <button onClick={() => setCurrentPage('home')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üè†</div><span className="text-[11px] font-medium">Home</span></button>
                <button onClick={() => setCurrentPage('goals')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üéØ</div><span className="text-[11px] font-medium">Goals</span></button>
                <button onClick={() => setCurrentPage('chat')} className="flex flex-col items-center rounded-lg py-1 text-slate-600 hover:bg-slate-50"><div className="text-xl">üë•</div><span className="text-[11px] font-medium">Heroes</span></button>
                <button className="flex flex-col items-center rounded-lg py-1 text-accent-600 bg-accent-50 font-semibold"><div className="text-xl">üë§</div><span className="text-[11px]">Profile</span></button>
              </div>
            </div>
          </div>
        </Shell>
      );

      // ---------------- Reminders Page ----------------
      const Reminders = () => {
        const [local, setLocal] = useState(reminders);
        const weekdays = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

        // Derived states
        const permText = perm === 'default' ? 'Not requested' : (perm === 'granted' ? 'Granted' : 'Denied');

        const toggleDay = (i) => {
          const set = new Set(local.dialysis.days);
          if (set.has(i)) set.delete(i); else set.add(i);
          setLocal({...local, dialysis: {...local.dialysis, days: Array.from(set).sort()}});
        };

        const saveAll = () => {
          setReminders(local);
          notify('Reminders saved & scheduled ‚úÖ');
        };

        const sendTest = () => {
          showBrowserNotification({
            title: 'üîî Test notification',
            body: 'If you see this, notifications are working!',
            tag: 'test',
            data: { url: location.href }
          }).then(ok => { if (!ok) notify('Test shown in-app (browser blocked push).'); });
        };

        const demoTriggers = () => {
          // Fire each type in a few seconds for demo
          setTimeout(()=> showBrowserNotification({ title:'üíä Medication', body:'Time to take your medication.', tag:'demo-med', data:{url:location.href+'#meds'} }), 1500);
          setTimeout(()=> showBrowserNotification({ title:'ü©∫ Dialysis', body:'Session starts soon. Do a quick check-in?', tag:'demo-dialysis', data:{url:location.href+'#dialysis'} }), 3000);
          setTimeout(()=> showBrowserNotification({ title:'üíß Hydration', body:'Quick sip to stay on target.', tag:'demo-hydration', data:{url:location.href} }), 4500);
          notify('Demo notifications queued‚Ä¶');
        };

        return (
          <Shell>
            <Notification notice={notice} />
            <div className="rene-gradient floating-header">
              <Section className="py-5 flex items-center gap-3 text-white">
                <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
                <ReneBrand size="sm" />
                <span className="ml-auto text-lg font-bold">Reminders</span>
              </Section>
            </div>

            <Section className="py-6 space-y-6 pb-28">
              <Card className="p-5">
                <div className="flex items-center justify-between">
                  <div>
                    <div className="font-bold">Notifications</div>
                    <div className="text-xs text-slate-500">Permission: <span className="font-semibold">{permText}</span> ‚Ä¢ SW: {swReady ? 'Ready' : '‚Äî'}</div>
                  </div>
                  <div className="flex items-center gap-2">
                    <button onClick={requestPermission} className="px-3 py-2 rounded-lg text-sm bg-slate-100">Enable</button>
                    <label className="inline-flex items-center gap-2 text-sm">
                      <input type="checkbox" checked={local.enabled} onChange={(e)=>setLocal({...local, enabled: e.target.checked})}/>
                      <span>Reminders on</span>
                    </label>
                  </div>
                </div>
                <div className="mt-3 flex gap-2">
                  <button onClick={sendTest} className="px-3 py-2 rounded-lg text-sm bg-accent-600 text-white">Send test</button>
                  <button onClick={demoTriggers} className="px-3 py-2 rounded-lg text-sm bg-slate-100">Demo triggers</button>
                </div>
              </Card>

              <Card className="p-5">
                <div className="font-bold mb-3">Medication</div>
                <div className="space-y-3">
                  {local.meds.map((m, idx) => (
                    <div key={m.id} className="grid grid-cols-12 items-center gap-3">
                      <label className="col-span-5 text-sm">
                        <input type="text" value={m.name}
                               onChange={(e)=> {
                                 const copy = [...local.meds]; copy[idx] = {...m, name: e.target.value};
                                 setLocal({...local, meds: copy});
                               }}
                               className="w-full px-3 py-2 rounded-lg border border-slate-200"/>
                      </label>
                      <input className="col-span-4 px-3 py-2 rounded-lg border border-slate-200" type="time" value={m.time}
                             onChange={(e)=> { const copy=[...local.meds]; copy[idx]={...m, time:e.target.value}; setLocal({...local, meds:copy}); }}/>
                      <label className="col-span-3 justify-self-end text-sm inline-flex items-center gap-2">
                        <input type="checkbox" checked={m.enabled} onChange={(e)=>{ const copy=[...local.meds]; copy[idx]={...m, enabled:e.target.checked}; setLocal({...local, meds: copy}); }}/>
                        <span>Enabled</span>
                      </label>
                    </div>
                  ))}
                </div>
              </Card>

              <Card className="p-5">
                <div className="font-bold mb-3">Dialysis</div>
                <div className="grid sm:grid-cols-2 gap-3 items-center">
                  <label className="text-sm">Time
                    <input type="time" value={local.dialysis.time} className="mt-1 w-full px-3 py-2 rounded-lg border border-slate-200"
                           onChange={(e)=>setLocal({...local, dialysis: {...local.dialysis, time: e.target.value}})} />
                  </label>
                  <label className="text-sm inline-flex items-center gap-2">
                    <input type="checkbox" checked={local.dialysis.enabled} onChange={(e)=>setLocal({...local, dialysis:{...local.dialysis, enabled: e.target.checked}})}/>
                    <span>Enabled</span>
                  </label>
                </div>
                <div className="mt-3 flex flex-wrap gap-2">
                  {weekdays.map((d,i)=> (
                    <button type="button" key={d}
                            onClick={()=>toggleDay(i)}
                            className={`px-3 py-1 rounded-full text-sm border ${local.dialysis.days.includes(i) ? 'bg-accent-600 text-white border-accent-600' : 'bg-white text-slate-700 border-slate-200'}`}>
                      {d}
                    </button>
                  ))}
                </div>
              </Card>

              <Card className="p-5">
                <div className="font-bold mb-3">Hydration</div>
                <div className="grid sm:grid-cols-3 gap-3 items-center">
                  <label className="text-sm">Every (mins)
                    <input type="number" min="15" value={local.hydration.intervalMins} className="mt-1 w-full px-3 py-2 rounded-lg border border-slate-200"
                           onChange={(e)=>setLocal({...local, hydration: {...local.hydration, intervalMins: parseInt(e.target.value||'0',10)}})} />
                  </label>
                  <label className="text-sm">Active from
                    <input type="time" value={local.hydration.activeStart} className="mt-1 w-full px-3 py-2 rounded-lg border border-slate-200"
                           onChange={(e)=>setLocal({...local, hydration: {...local.hydration, activeStart: e.target.value}})} />
                  </label>
                  <label className="text-sm">to
                    <input type="time" value={local.hydration.activeEnd} className="mt-1 w-full px-3 py-2 rounded-lg border border-slate-200"
                           onChange={(e)=>setLocal({...local, hydration: {...local.hydration, activeEnd: e.target.value}})} />
                  </label>
                </div>
                <div className="mt-3">
                  <label className="text-sm inline-flex items-center gap-2">
                    <input type="checkbox" checked={local.hydration.enabled} onChange={(e)=>setLocal({...local, hydration: {...local.hydration, enabled: e.target.checked}})} />
                    <span>Enabled</span>
                  </label>
                </div>
              </Card>

              <div className="flex gap-3">
                <button onClick={saveAll} className="px-4 py-2 rounded-lg bg-accent-600 text-white font-semibold">Save & Schedule</button>
                <button onClick={()=>setReminders(defaultReminders)} className="px-4 py-2 rounded-lg bg-slate-100">Reset defaults</button>
              </div>

              <Card className="p-5">
                <div className="text-sm text-slate-600">
                  <p className="mb-2">‚ÑπÔ∏è <span className="font-semibold">How it works:</span> Reminders are scheduled locally while the app/PWA is open. To receive them when the app is closed, you‚Äôll need Push API with a small backend service. This demo already shows real notifications using the browser‚Äôs Notification API and a Service Worker when available, with an in-app fallback banner.</p>
                </div>
              </Card>
            </Section>
          </Shell>
        );
      };

      const Wellness = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Wellness</span>
            </Section>
          </div>
          <Section className="py-6 space-y-4 pb-28">
            <Card className="p-5"><div className="font-semibold mb-2">Mindfulness</div><button className="px-4 py-2 rounded bg-accent-600 text-white" onClick={()=>notify('Breathing started')}>Start breathing</button></Card>
            <Card className="p-5"><div className="font-semibold mb-2">Guided audio</div><button className="px-4 py-2 rounded bg-slate-100" onClick={()=>notify('Playing 5-min relax')}>Play 5-min relax</button></Card>
          </Section>
        </Shell>
      );

      const Symptoms = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Symptom Tracker</span>
            </Section>
          </div>
          <Section className="py-6 space-y-4 pb-28">
            <Card className="p-5 space-y-3">
              <label className="block text-sm">Nausea (0‚Äì10)</label>
              <input type="range" min="0" max="10" className="w-full"/>
              <label className="block text-sm">Fatigue (0‚Äì10)</label>
              <input type="range" min="0" max="10" className="w-full"/>
              <label className="block text-sm">Cramps (0‚Äì10)</label>
              <input type="range" min="0" max="10" className="w-full"/>
              <button className="px-4 py-2 rounded bg-accent-600 text-white" onClick={()=>notify('Symptoms saved')}>Save</button>
            </Card>
          </Section>
        </Shell>
      );

      const Meds = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
            <span className="ml-auto text-lg font-bold">Medication Overview</span>
            </Section>
          </div>
          <Section className="py-6 space-y-4 pb-28">
            <Card className="p-5">
              <div className="font-semibold mb-2">Today</div>
              <ul className="text-sm list-disc pl-5 space-y-1">
                <li>Sevelamer 800 mg ‚Äî 08:30</li>
                <li>Erythropoietin ‚Äî 18:00</li>
              </ul>
              <button className="mt-3 px-4 py-2 rounded bg-slate-100" onClick={()=>notify('Reminders configured')}>Configure reminders</button>
            </Card>
          </Section>
        </Shell>
      );

      const Dialysis = () => (
        <Shell>
          <Notification notice={notice} />
          <div className="rene-gradient floating-header">
            <Section className="py-5 flex items-center gap-3 text-white">
              <button onClick={() => setCurrentPage('home')} className="text-2xl">‚Üê</button>
              <ReneBrand size="sm" />
              <span className="ml-auto text-lg font-bold">Dialysis</span>
            </Section>
          </div>
          <Section className="py-6 space-y-5 pb-28">
            <Card className="p-5">
              <div className="flex items-center justify-between">
                <div>
                  <div className="font-bold">Session tools</div>
                  <div className="text-xs text-slate-500">Check-ins, games & entertainment</div>
                </div>
                {!dialysisActive ? (
                  <button className="px-4 py-2 rounded bg-accent-600 text-white" onClick={startDialysis}>Start session</button>
                ) : (
                  <button className="px-4 py-2 rounded bg-rose-600 text-white" onClick={stopDialysis}>End session</button>
                )}
              </div>
            </Card>
            <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <Card className="p-5 cursor-pointer" onClick={()=>setCurrentPage('symptoms')}>
                <div className="text-2xl mb-2">üôÇ</div>
                <div className="font-bold">Mood & Symptoms</div>
                <div className="text-sm text-slate-600">Quick PROMs during session</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={()=>notify('Opening mini games') }>
                <div className="text-2xl mb-2">üéÆ</div>
                <div className="font-bold">Mini-games</div>
                <div className="text-sm text-slate-600">Light games to pass time</div>
              </Card>
              <Card className="p-5 cursor-pointer" onClick={()=>notify('Opening entertainment hub') }>
                <div className="text-2xl mb-2">üéß</div>
                <div className="font-bold">Entertainment</div>
                <div className="text-sm text-slate-600">Music, podcasts, videos</div>
              </Card>
            </div>
          </Section>
        </Shell>
      );

      // Router
      const Page = () => {
        switch (currentPage) {
          case 'home': return <Home/>;
          case 'goals': return <Goals/>;
          case 'reminders': return <Reminders/>;
          case 'chat': return <Chat/>;
          case 'profile': return <Profile/>;
          case 'wellness': return <Wellness/>;
          case 'symptoms': return <Symptoms/>;
          case 'meds': return <Meds/>;
          case 'dialysis': return <Dialysis/>;
          default: return <Home/>;
        }
      };

      return <Page/>;
    };

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>
